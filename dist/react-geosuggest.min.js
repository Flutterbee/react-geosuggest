!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.Geosuggest=t()}}(function(){return function t(e,s,i){function a(n,u){if(!s[n]){if(!e[n]){var l="function"==typeof require&&require;if(!u&&l)return l(n,!0);if(o)return o(n,!0);var r=new Error("Cannot find module '"+n+"'");throw r.code="MODULE_NOT_FOUND",r}var c=s[n]={exports:{}};e[n][0].call(c.exports,function(t){var s=e[n][1][t];return a(s?s:t)},c,c.exports,t,e,s,i)}return s[n].exports}for(var o="function"==typeof require&&require,n=0;n<i.length;n++)a(i[n]);return a}({1:[function(t,e){"use strict";function s(t){return t&&t.__esModule?t:{"default":t}}var i=window.React,a=s(i),o=t("./GeosuggestItem"),n=s(o),u=a["default"].createClass({displayName:"Geosuggest",getDefaultProps:function(){return{fixtures:[],initialValue:"",placeholder:"Search places",disabled:!1,className:"",location:null,radius:0,bounds:null,country:null,types:null,googleMaps:null,onSuggestSelect:function(){},onFocus:function(){},onBlur:function(){},onChange:function(){},skipSuggest:function(){},getSuggestLabel:function(t){return t.description},autoActivateFirstSuggest:!1,autoShowSuggest:!1}},getInitialState:function(){return{isSuggestsHidden:!0,userInput:this.props.initialValue,placeholder:this.props.placeholder,activeSuggest:null,fixtures:this.props.fixtures,suggests:[],disabled:this.props.disabled,className:this.props.className}},componentDidUpdate:function(){this.props.blurred&&(this.hideSuggests(),a["default"].findDOMNode(this.refs.geosuggestInput).blur())},componentWillReceiveProps:function(t){if(this.props.initialValue!==t.initialValue&&this.setState({userInput:t.initialValue}),t.coordinates){var e=t.coordinates.split(","),s={lat:parseFloat(e[0]),lng:parseFloat(e[1])};this.reverseGeocode(s,!1,!1)}this.setState({fixtures:t.fixtures}),this.props.autoShowSuggest&&(this.state.fixtures=t.fixtures,this.showSuggests())},componentDidMount:function(){var t=this.props.googleMaps||google&&google.maps||this.googleMaps;t&&(this.googleMaps=t),this.autocompleteService=new t.places.AutocompleteService,this.geocoder=new t.Geocoder,this.refs["big-locality"].style.display="none",this.setInputValue({value:this.props.initialValue,placeId:this.props.placeId})},setInputValue:function(t){var e=this;t.value?this.setState({userInput:t.value}):t.placeId&&this.geocoder.geocode({placeId:t.placeId},function(t){var s=t[0],i=(s.geometry.location,s.formatted_address);e.setState({userInput:i}),e.hideSuggests()})},onInputChange:function(){var t=this.refs.geosuggestInput.value;this.setState({userInput:t},function(){this.showSuggests(),this.props.onChange(t)}.bind(this))},onFocus:function(){"loading-geolocation"===this.state.className&&this.setState({userInput:"",className:""}),this.props.onFocus(),this.showSuggests()},update:function(t){this.setState({userInput:t}),this.props.onChange(t)},clear:function(){this.setState({userInput:""}),this.refs.geosuggestInput.focus()},searchSuggests:function(){if(!this.state.userInput)return void this.updateSuggests();var t={input:this.state.userInput,location:this.state.location||new this.googleMaps.LatLng(0,0),radius:this.state.radius||0};this.props.bounds&&(t.bounds=this.props.bounds),this.props.types&&(t.types=this.props.types),this.props.country&&(t.componentRestrictions={country:this.props.country}),this.autocompleteService.getPlacePredictions(t,function(t){this.updateSuggests(t),this.props.autoActivateFirstSuggest&&this.activateSuggest("next")}.bind(this))},isAlreadyPresnt:function(t,e){for(var s=t.length-1;s>=0;s--)if(t[s].placeId===e.place_id)return!0;return!1},updateSuggests:function(t){var e=this,s=this;t||(t=[]);var i=[],a=new RegExp(this.state.userInput,"gim"),o=this.props.skipSuggest;this.state.fixtures.forEach(function(t){o(t.gmaps)||s.state.userInput&&!t.label.match(a)||(t.placeId=t.placeId||t.label,i.push(t))}),t.forEach(function(t){o(t)||e.isAlreadyPresnt(i,t)||i.push({label:e.props.getSuggestLabel(t),placeId:t.place_id})}),this.setState({suggests:i})},showSuggests:function(){this.searchSuggests(),this.setState({isSuggestsHidden:!1})},hideSuggests:function(){this.props.onBlur(),setTimeout(function(){this.setState({isSuggestsHidden:!0})}.bind(this),100)},clearLocality:function(){this.setState({locality:void 0,placeholder:this.props.placeholder,activeSuggest:void 0}),this.refs["big-locality"].style.display="none",this.refs.geosuggestInput.style["padding-left"]="32px"},clearIfLocality:function(){""===this.state.userInput&&this.clearLocality()},onInputKeyDown:function(t){switch(t.which){case 40:t.preventDefault(),this.activateSuggest("next");break;case 38:t.preventDefault(),this.activateSuggest("prev");break;case 13:t.preventDefault(),this.selectSuggest(this.state.activeSuggest);break;case 9:this.selectSuggest(this.state.activeSuggest);break;case 27:this.hideSuggests();break;case 8:this.clearIfLocality()}},activateSuggest:function(t){if(this.state.isSuggestsHidden)return void this.showSuggests();var e=this.state.suggests.length-1,s="next"===t,i=null,a=0,o=0;for(o;e>=o;o++)this.state.suggests[o]===this.state.activeSuggest&&(a=s?o+1:o-1);this.state.activeSuggest||(a=s?0:e),a>=0&&e>=a&&(i=this.state.suggests[a]),this.setState({activeSuggest:i})},selectSuggest:function(t){if(t){if(this.setState({isSuggestsHidden:!0}),t.type&&"geolocate"===t.type){var e=function(e){var s=e.coords.latitude,a=e.coords.longitude,o=e.coords.accuracy;t.position=e;var n={lat:parseFloat(s),lng:parseFloat(a)};i.reverseGeocode(n,t,o)},s=function(t){return alert("We are unable to locate you. Please check your location settings."),i.setState({userInput:i.props.initialValue,className:i.props.className}),!1};if(!navigator.geolocation)return void alert("Sorry! Your browser does not support geolocation. Please enter your locality manually.");this.setState({userInput:"Fetching Location...",className:"loading-geolocation"});var i=this;return void navigator.geolocation.getCurrentPosition(e,s,{enableHighAccuracy:!0})}return t.skipGeoCoding||t.location?(this.setState({userInput:t.label}),this.clearLocality(),void this.props.onSuggestSelect(t)):void this.geocodeSuggest(t)}},reverseGeocode:function(t,e,s){var i=this;this.geocoder.geocode({location:t},function(a,o){if(o===google.maps.GeocoderStatus.OK&&a[1]){if(t.formattedAddress=a[1].formatted_address,s>100){var n=window.confirm("Are you located at "+t.formattedAddress.toString()+"?\n");if(n!==!0)return alert("Please enter your location manually."),void i.setState({userInput:i.props.initialValue,className:i.props.className})}i.setState({userInput:t.formattedAddress,className:i.props.className}),"object"==typeof e&&(e.gmaps={formatted_address:t.formattedAddress},i.props.onSuggestSelect(e))}})},geocodeSuggest:function(t){var e={};t.placeId?e.placeId=t.placeId:t.label&&(e.address=t.label),this.geocoder.geocode(e,function(e,s){if(s===this.googleMaps.GeocoderStatus.OK){var i=e[0],a=i.geometry.location;t.gmaps=i,this.setState({userInput:t.label}),t.location={lat:a.lat(),lng:a.lng()},this.clearLocality(),this.props.onSuggestSelect(t)}}.bind(this))},render:function(){var t=this.state.locality?"block":"none";return a["default"].createElement("div",{className:"geosuggest "+this.state.className,onClick:this.onClick},a["default"].createElement("input",{className:"geosuggest__input",ref:"geosuggestInput",type:"text",value:this.state.userInput,placeholder:this.state.placeholder,disabled:this.state.disabled,onKeyDown:this.onInputKeyDown,onChange:this.onInputChange,onFocus:this.onFocus,onBlur:this.hideSuggests}),a["default"].createElement("div",{ref:"edit-locality",onClick:this.clear,className:["edit-locality",this.state.userInput?"":"hidden"].join(" ")},a["default"].createElement("span",null,"Change")),a["default"].createElement("div",{ref:"big-locality",className:"locality",style:{display:t}},a["default"].createElement("span",null,this.state.locality),a["default"].createElement("span",{onClick:this.clearLocality,className:"delete-icon"},"X")),a["default"].createElement("div",{className:"marker-icon"}),a["default"].createElement("ul",{className:this.getSuggestsClasses()},this.getSuggestItems()))},getSuggestItems:function(){return!this.state.suggests.length&&this.state.userInput&&this.state.suggests.push({label:"No results found",className:"no-results"}),this.props.showGeoLocate&&!this.state.userInput&&(0==this.state.suggests.length||"geolocate"!==this.state.suggests[0].type)&&this.state.suggests.unshift({label:"Use my location",className:"geolocate",type:"geolocate"}),this.state.suggests.map(function(t){var e=this.state.activeSuggest&&t.placeId===this.state.activeSuggest.placeId;return a["default"].createElement(n["default"],{key:t.placeId,suggest:t,isActive:e,onSuggestSelect:this.selectSuggest})}.bind(this))},getSuggestsClasses:function(){var t="geosuggest__suggests";return t+=this.state.isSuggestsHidden?" geosuggest__suggests--hidden":""}});e.exports=u},{"./GeosuggestItem":2}],2:[function(t,e){"use strict";function s(t){return t&&t.__esModule?t:{"default":t}}var i=window.React,a=s(i),o=a["default"].createClass({displayName:"GeosuggestItem",getDefaultProps:function(){return{isActive:!1,suggest:{label:""},onSuggestSelect:function(){}}},onClick:function(t){t.preventDefault(),this.props.onSuggestSelect(this.props.suggest)},render:function(){var t=this.props.suggest.label.split(","),e=t.splice(t.length-3).join(","),s=t.join(",");return a["default"].createElement("li",{className:this.getSuggestClasses(),onClick:this.onClick},a["default"].createElement("div",null,a["default"].createElement("span",{className:"locality-item"},s),a["default"].createElement("span",{className:"city-item"},e)))},getSuggestClasses:function(){var t=this.props.suggest.className,e="geosuggest-item";return e+=this.props.isActive?" geosuggest-item--active":"",e+=t?" "+t:""}});e.exports=o},{}]},{},[1])(1)});